
    Set-ExecutionPolicy Bypass -Scope Process -Force
    [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
    iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

choco feature enable -n allowGlobalConfirmation

cinst boxstarter

powershell -Command "Set-ExecutionPolicy RemoteSigned; iex ((New-Object System.Net.WebClient).DownloadString('https://boxstarter.org/bootstrapper.ps1')); get-boxstarter -Force"
powershell -Command "Disable-UAC"

# Lista tool
$tools = @(
    "hackfont",
    "vim",
    "firefox",
    "googlechrome",
    "wget",
    "python3",
    "7zip",
    "tor-browser",
    "wireshark",
    "git",
    "cmder",
    "ollydbg",
    "processhacker",
    "explorersuite",
    "procexp",
    "md5deep",
    "hashdeep",
    "file",
    "strings",
    "regshot",
    "sysinternal",
    "exeinfo",
    "virustotaluploader",
    "vt-cli",
    "radare2",
    "mitmproxy",
    "fiddler",
    "hxd",
    "exiftool"
)

# Installa i tool
foreach ($tool in $tools) {
    if (-not (choco list --local-only | Select-String $tool)) {
        Write-Output "Sto installando $tool..."
        choco install $tool -y
    } else {
        Write-Output "$tool è già installato."
    }
}

# Configurazioni aggiuntive
New-Item -Path "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU" -Force
Set-ItemProperty -Path "HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name "NoAutoUpdate" -Value 1

powershell -Command "Set-MpPreference -DisableRealtimeMonitoring $true"

powershell -Command "Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False"

# aggiungere i sample dei malware in automatico 
# crack della nonna (non so se conviene, potrebbe fare rumore durante le analisi. Non aggiungere codici seriali veri, i malware potrebbero sniffarli).
# Aggiungere qualcosa  per zittire la telemetria
# aggiungere script a parte per gli aggiornamenti mancati su windows 7. Powershell 2.0 non è adatta per chocolatey e boxstarter, non usa TSL di default.
